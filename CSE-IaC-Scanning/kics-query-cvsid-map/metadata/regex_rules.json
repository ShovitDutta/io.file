{
  "rules": [
    {
      "id": "7c7cfa08-3760-45ce-b8d4-94ef7ddf8675",
      "name": "CN-0001:Generic Password",
      "regex": "(?i)['\"]?password['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-. ]{4,})['\"]?",
      "allowRules": [
        {
          "description": "Avoiding TF resource access",
          "regex": "(?i)['\"]?password['\"]?\\s*=\\s*(([a-zA-z_]+(.))?[a-zA-z_]+\\s*(.)\\s*[a-zA-z_]+(.)[a-zA-z_]+)?(\\s*:\\s*null|null)$"
        },
        {
          "description": "Avoiding CF AllowUsersToChangePassword",
          "regex": "['\"]?AllowUsersToChangePassword['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-.]{4,})['\"]?"
        },
        {
          "description": "Avoiding Ansible playbook update_password",
          "regex": "['\"]?update_password['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-.]{4,})['\"]?"
        }
      ],
      "specialMask": "(?i)['\"]?password['\"]?\\s*[:=]\\s*"
    },
    {
      "id": "c4c29d37-1973-4d2b-b3c8-8215d6f1d365",
      "name": "CN-0002:Generic Secret",
      "regex": "(?i)['\"]?secret[_]?(key)?['\"]?\\s*(:|=)\\s*['\"]?([A-Za-z0-9/~^_!@#&%(){};=?*+-<>,:;[\\]%$]{10,})['\"]?",
      "entropies": [
        {
          "group": 3,
          "min": 2.8,
          "max": 8
        }
      ],
      "allowRules": [
        {
          "description": "Avoiding Square OAuth Secret",
          "regex": "(?i)['\"]?secret[_]?(key)?['\"]?\\s*(:|=)\\s*['\"]?(sq0csp-[0-9A-Za-z\\-_]{43})['\"]?"
        },
        {
          "description": "Avoiding TF resource access",
          "regex": "(?i)['\"]?secret[_]?(key)?['\"]?\\s*=\\s*([a-zA-z_]+(.))?[a-zA-z_]+(.)[a-zA-z_]+(.)[a-zA-z_]+"
        },
        {
          "description": "Avoiding Secrets Manager arn",
          "regex": ":secretsmanager:[a-z0-9-*?]+:[0-9*?]+:(?i)['\"]?secret[_]?(key)?['\"]?\\s*(:|=)\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        },
        {
          "description": "Avoiding CloudFormation Parameters Descriptions",
          "regex": "['\"]?Description['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*${}+-.'\"]+)['\"]?"
        }
      ],
      "specialMask": "(?i)['\"]?secret[_]?(key)?['\"]?\\s*(:|=)\\s*"
    },
    {
      "id": "ca0289ad-b307-4219-90bc-b2177b050114",
      "name": "CN-0003:Asymmetric private key",
      "regex": "-----BEGIN ((EC|PGP|DSA|RSA|OPENSSH) )?PRIVATE KEY( BLOCK)?-----\\s*(([A-Za-z0-9+,:\\-\\/=\\n\\r]+\\s*)+)-----END ((EC|PGP|DSA|RSA|OPENSSH) )?PRIVATE KEY( BLOCK)?-----",
      "multiline": {
        "detectLineGroup": 4
      },
      "entropies": [
        {
          "group": 5,
          "min": 3.7,
          "max": 12
        }
      ],
      "specialMask": "all"
    },
    {
      "id": "d5c9b074-4f81-4266-946c-a400190654bd",
      "name": "CN-0004:Putty User Key File Content",
      "regex": "['\"]?PuTTY-User-Key-File-\\d: ([\\w\\d-:\\n\\s+/=]+Private-MAC: [\\d\\w\"]+)['\"]?",
      "multiline": {
        "detectLineGroup": 1
      },
      "specialMask": "all"
    },
    {
      "id": "c8aa42df-a4f1-4aec-8a1e-a27cfdba72f6",
      "name": "CN-0005:Password in URL",
      "regex": "['\"]?[a-zA-Z]{3,10}://[^/\\s:@$]*?:[^/\\s:@$]*?@[^/\\s:@$]*['\"]?"
    },
    {
      "id": "7a8e2e80-33e4-4384-b97d-019c4174c8ae",
      "name": "CN-0006:AWS Access Key",
      "regex": "(A3T[A-Z0-9]|AKIA|ASIA)[A-Z0-9]{16}"
    },
    {
      "id": "4deb3fec-717b-4a1e-9ed5-970886c4f14c",
      "name": "CN-0007:AWS Context-specific credential",
      "regex": "(A3T[A-Z0-9]|ACCA)[A-Z0-9]{16}"
    },
    {
      "id": "184feb8f-f269-4fa7-9e21-76632b09c3b8",
      "name": "CN-0008:AWS Certificate",
      "regex": "(A3T[A-Z0-9]|ASCA)[A-Z0-9]{16}"
    },
    {
      "id": "b00abd35-4223-45c0-84d4-12b790c8c6c5",
      "name": "CN-0009:AWS Secret Key",
      "regex": "(?i)AWS_SECRET(_ACCESS)?(_KEY)?\\s*[:=]\\s*['\"]?([a-zA-Z0-9/]{40})[\"']?",
      "entropies": [
        {
          "group": 3,
          "min": 4.8,
          "max": 7
        }
      ],
      "specialMask": "(?i)AWS_SECRET(_ACCESS)?(_KEY)?\\s*[:=]\\s*"
    },
    {
      "id": "20e54dd2-af95-490e-86d4-be03fece2331",
      "name": "CN-0010:K8s Environment Variable Password",
      "regex": "apiVersion((.*)\\s*)*env:((.*)\\s*)*name:\\s*\\w+(?i)pass((?i)word)?\\w*\\s*(value):\\s*([\"|'].*[\"|'])",
      "multiline": {
        "detectLineGroup": 7
      },
      "specialMask": "\\s*(value):\\s*"
    },
    {
      "id": "2593a53c-3d9a-42f7-9742-c00c4f1fb8b0",
      "name": "CN-0011:Google OAuth",
      "regex": "['\"]?[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com['\"]?"
    },
    {
      "id": "0c51a4f3-c706-4d84-b0d1-923e6b307ff1",
      "name": "CN-0012:Slack Webhook",
      "regex": "['\"]?https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}['\"]?"
    },
    {
      "id": "cb060463-d73a-4c57-a9a3-fde7d1f1199d",
      "name": "CN-0013:MSTeams Webhook",
      "regex": "['\"]?https://[a-zA-Z0-9_]{1,24}.webhook.office.com/webhook(b2)?/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}@[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/IncomingWebhook/[a-z0-9]+/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}['\"]?"
    },
    {
      "id": "979f4bd3-2609-400c-a534-e8f5395f1ff9",
      "name": "CN-0014:Slack Token",
      "regex": "['\"]?(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})['\"]?"
    },
    {
      "id": "5322f6d5-cb30-4fd8-9d4d-b1e6bd514346",
      "name": "CN-0015:Stripe API Key",
      "regex": "['\"]?sk_live_[0-9a-zA-Z]{24}[^0-9a-zA-Z]['\"]?"
    },
    {
      "id": "b7e1302d-9d7f-4a2e-8caf-d5e02f6384cf",
      "name": "CN-0016:Square Access Token",
      "regex": "sq0atp-[0-9A-Za-z\\-_]{22}"
    },
    {
      "id": "9e0fd282-7ebf-41fa-aaf8-073824dcfbee",
      "name": "CN-0017:MailChimp API Key",
      "regex": "[0-9a-f]{32}-us[0-9]{1,2}"
    },
    {
      "id": "289d34be-225a-41ed-ae27-a96032b8fcec",
      "name": "CN-0018:Google API Key",
      "regex": "['\"]?AIza[0-9A-Za-z\\-_]{35}['\"]?"
    },
    {
      "id": "66206249-b7f4-4176-9e11-9a9dcbff6665",
      "name": "CN-0019:Heroku API Key",
      "regex": "['\"]?(?i)heroku((.|\\n)*)\\b([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})\\b['\"]?",
      "multiline": {
        "detectLineGroup": 3
      },
      "specialMask": "['\"]?(?i)api_key[^\\w\"']+"
    },
    {
      "id": "24652f0f-845c-4573-ae0e-5d19f935e5a0",
      "name": "CN-0020:Square OAuth Secret",
      "regex": "['\"]?sq0csp-[0-9A-Za-z\\-_]{43}['\"]?"
    },
    {
      "id": "8da14f82-d01a-4225-8f0a-79309ad0b4e9",
      "name": "CN-0021:Amazon MWS Auth Token",
      "regex": "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}"
    },
    {
      "id": "08bd73ef-e127-4125-b10d-d24bf815694a",
      "name": "CN-0022:Google OAuth Access Token",
      "regex": "ya29\\.[0-9A-Za-z\\-_]+"
    },
    {
      "id": "7eced883-eb0a-45a7-bb83-ef34c51f38d6",
      "name": "CN-0023:PayPal Braintree Access Token",
      "regex": "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}"
    },
    {
      "id": "fcb3e9d3-46b8-4993-a0ce-a84dde504087",
      "name": "CN-0024:Stripe Restricted API Key",
      "regex": "['\"]?rk_live_[0-9a-zA-Z]{24}['\"]?"
    },
    {
      "id": "c44aff47-ae73-4e72-999a-35a9ecc52898",
      "name": "CN-0025:Facebook Access Token",
      "regex": "['\"]?EAACEdEose0cBA[0-9A-Za-z]+['\"]?"
    },
    {
      "id": "a83b8b61-bb52-485e-b2b9-294032e8b2c8",
      "name": "CN-0026:Generic API Key",
      "regex": "(?i)['\"]?api[_]?key['\"]?\\s*[:=]\\s*['\"]?([0-9a-zA-Z]{32,45})['\"]?",
      "allowRules": [
        {
          "description": "Avoiding Twilio API Key",
          "regex": "(?i)['\"]?api[_]?key['\"]?\\s*[:=]\\s*['\"]?(SK[0-9a-fA-F]{32})['\"]?"
        }
      ],
      "specialMask": "(?i)['\"]?api[_]?key['\"]?\\s*[:=]\\s*"
    },
    {
      "id": "b4e367ec-1d4f-4ff3-b841-0a023d38f772",
      "name": "CN-0027:Mailgun API Key",
      "regex": "['\"]?key-[0-9a-zA-Z]{32}['\"]?"
    },
    {
      "id": "bca63a52-5ed0-4856-9147-f00f2aa1d8c2",
      "name": "CN-0028:Picatic API Key",
      "regex": "sk_live_[0-9a-z]{32}"
    },
    {
      "id": "41d01146-7d45-47f7-843c-06dee4fab1a3",
      "name": "CN-0029:Twilio API Key",
      "regex": "SK[0-9a-fA-F]{32}"
    },
    {
      "id": "83b56799-24cb-4b58-a762-5667d22fef38",
      "name": "CN-0030:Generic Access Key",
      "regex": "(?i)^\\s*['\"]?(access)[_]?key['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9\/~^_!@&%()=?*+-]+)['\"]?",
      "specialMask": "(?i)['\"]?access[_]?key['\"]?\\s*[:=]\\s*"
    },
    {
      "id": "5903cbae-7b3d-41c1-b939-edabae2fc724",
      "name": "CN-0031:Generic Private Key",
      "regex": "(?i)['\"]?private[_]?key['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?",
      "specialMask": "(?i)['\"]?private[_]?key['\"]?\\s*[:=]\\s*",
      "allowRules": [
        {
          "description": "Avoiding bash variables",
          "regex": "(?i)['\"]?\\$\\s*\\{[^\\s\\}]+\\}['\"]?"
        }
      ]
    },
    {
      "id": "0b948deb-7150-4fc0-8182-cd177456fd77",
      "name": "CN-0032:Generic Token",
      "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?",
      "allowRules": [
        {
          "description": "Avoiding Amazon MWS Auth Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})['\"]?"
        },
        {
          "description": "Avoiding Slack Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})['\"]?"
        },
        {
          "description": "Avoiding Square Access Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(sq0atp-[0-9A-Za-z\\-_]{22})['\"]?"
        },
        {
          "description": "Avoiding Google OAuth Access Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(ya29\\.[0-9A-Za-z\\-_]+)['\"]?"
        },
        {
          "description": "Avoiding PayPal Braintree Access Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32})['\"]?"
        },
        {
          "description": "Avoiding Facebook Access Token",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[=:]\\s*['\"]?(EAACEdEose0cBA[0-9A-Za-z]+)['\"]?"
        },
        {
          "description": "Avoiding TF resource access",
          "regex": "(?i)['\"]?token(_)?(key)?['\"]?\\s*=\\s*([a-zA-z_]+(.))?[a-zA-z_]+(.)[a-zA-z_]+(.)[a-zA-z_]+"
        },
        {
          "description": "Avoiding TF creation token",
          "regex": "(?i)['\"]?creation_token['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        },
        {
          "description": "Avoiding CLoudformation ServiceToken",
          "regex": "['\"]?ServiceToken['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-.]+)['\"]?"
        },
        {
          "description": "Avoiding LifecycleActionToken Var",
          "regex": "(?i)['\"]?LifecycleActionToken['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        },
        {
          "description": "Avoiding Github id-token Default Values",
          "regex": "(?i)['\"]?id-token\\s*[:=]\\s*(write|read|none)\\s*$"
        },
        {
          "description": "Avoiding result_token Var",
          "regex": "(?i)['\"]?result(_)?token['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        },
        {
          "description": "Avoiding next_token Var",
          "regex": "(?i)['\"]?next(_)?token['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        },
        {
          "description": "Avoiding next_token Var",
          "regex": "(?i)['\"]?next(_)?token['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?"
        }
      ],
      "specialMask": "(?i)['\"]?token(_)?(key)?['\"]?\\s*[:=]\\s*"
    },
    {
      "id": "2dee6e48-e536-4ab0-b389-a0d4e20117d2",
      "name": "CN-0033:CloudFormation Secret Template",
      "regex": "(?i)['\"]?SecretStringTemplate['\"]?\\s*:\\s*['\"]?{([\\\":A-Za-z0-9/~^_!@&%()=?*+-]{10,})}",
      "specialMask": "(?i)['\"]?SecretStringTemplate['\"]?\\s*:\\s*"
    },
    {
      "id": "86be1d5b-98d0-4a47-8a4c-46b5bd28d57b",
      "name": "CN-0034:Encryption Key",
      "regex": "(?i)['\"]?encryption[_]?key['\"]?\\s*[:=]\\s*['\"]?([[A-Za-z0-9/~^_!@&%()=?*+-]+)['\"]?",
      "allowRules": [
        {
          "description": "Avoiding TF resource access",
          "regex": "(?i)['\"]?encryption[_]?key['\"]?\\s*=\\s*([a-zA-z_]+(.))?[a-zA-z_]+(.)[a-zA-z_]+(.)[a-zA-z_]+"
        },
        {
          "description": "Avoiding CLoudformation KeyName",
          "regex": "['\"]?EncryptionKey['\"]?\\s*[:=]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-.]+)['\"]?"
        }
      ],
      "specialMask": "(?i)['\"]?encryption[_]?key['\"]?\\s*[:=]\\s*"
    },
    {
      "id": "d2083f68-4e55-4a18-a257-4b845facc4ac",
      "name": "CN-0035:SendGrid API Key",
      "regex": "(?i)SG\\.[a-zA-Z0-9\\-\\_]{22}\\.[a-zA-Z0-9\\-\\_]{43}\\s*"
    },
    {
      "id": "4afb6e4d-0a15-44fa-adb2-ee1e820a2a2d",
      "name": "CN-0036:Generic Password on YAML files when value in tuple",
      "regex": ".*password\\s*:[\\n|\\r]\\s*value:([^\\n|\\r]*)",
      "multiline": {
        "detectLineGroup": 1
      },
      "specialMask": ".*password\\s*:[\\n|\\r]\\s*value:"
    }
  ],
  "allowRules": [
    {
      "description": "Avoiding TF variables",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*=\\s*['\"]?(var\\.)['\"]?"
    },
    {
      "description": "!Ref is a cloudFormation reference",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*:\\s+!Ref\\s+\\.*"
    },
    {
      "description": "Avoiding cloudFormation intrinsic functions",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*:\\s+(!GetAtt|!Sub|!FindInMap|!If|!GetAZs|!ImportValue|!Join|!Select|!Split|!Not|Fn::Transform(:)?)\\s+\\.*"
    },
    {
      "description": "Avoiding CF resolve",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?({{resolve:)['\"]?"
    },
    {
      "description": "Avoiding Boolean's",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?(true|false)['\"]?"
    },
    {
      "description": "Avoiding arn",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?(arn:)['\"]?"
    },
    {
      "description": "Avoiding array access",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?([A-Za-z0-9/~^_!@&%()=?*+-.]{4,}\\[([0-9]|['\"][a-zA-Z0-9]+['\"])\\])['\"]?"
    },
    {
      "description": "Avoiding TF file function",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*=\\s*['\"]?(file\\()['\"]?"
    },
    {
      "description": "Avoiding ansible-vault encrypted variables",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?(!vault \\|)['\"]?"
    },
    {
      "description": "Avoiding sha-hashed mysql native passwords",
      "regex": "(?i)['\"]?[a-zA-Z_]+['\"]?\\s*[=:]\\s*['\"]?(\\*[0-9A-F]{40})['\"]?"
    }
  ]
}
