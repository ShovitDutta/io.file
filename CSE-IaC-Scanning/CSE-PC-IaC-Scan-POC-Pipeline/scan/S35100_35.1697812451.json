{
  "format_version": "1.2",
  "terraform_version": "1.6.2",
  "variables": {
    "access": {
      "value": [
        {
          "members": [
            "serviceAccount:poc-sa@ddev.iam.gserviceaccount.com",
            "serviceAccount:cloud-build-deploy-sa@d.iam.gserviceaccount.com"
          ],
          "role": "roles/storage.objectAdmin"
        }
      ]
    },
    "bucket_encryption_key": {
      "value": [
        "p"
      ]
    },
    "bucket_labels": {
      "value": {
        "applicationid": "poc",
        "costcenter": "digital",
        "dataclassification": "proprietary",
        "owner": "platform-security"
      }
    },
    "bucket_location": { "value": "us-east4" },
    "bucket_name": { "value": "storage-bucket-poc" },
    "enable_versioning": { "value": false },
    "github_organization": { "value": "cvs" },
    "lifecycle_delete_age_rules": { "value": [5] },
    "lifecycle_storageclass_age_rules": {
      "value": [{ "age": 10, "storageClass": "STANDARD" }]
    },
    "log_bucket_name": { "value": "bucket-test5" },
    "project_id": { "value": "poc" },
    "region": { "value": "us-east4" },
    "retention_policy_values": {
      "value": { "is_locked": false, "retention_period": 3600 }
    },
    "zone": { "value": "us-east4-b" }
  },
  "planned_values": {
    "root_module": {
      "child_modules": [
        {
          "resources": [
            {
              "address": "module.cloud_Storage.google_storage_bucket.buckets",
              "mode": "managed",
              "type": "google_storage_bucket",
              "name": "buckets",
              "provider_name": "registry.terraform.io/hashicorp/google",
              "schema_version": 0,
              "values": {
                "bucket_policy_only": true,
                "cors": [],
                "default_event_based_hold": false,
                "encryption": [
                  {
                    "default_kms_key_name": "projects/cvs/locations/us-east4/keyRings/poc"
                  }
                ],
                "force_destroy": true,
                "id": "storage-bucket-poc",
                "labels": {
                  "applicationid": "poc",
                  "costcenter": "digital",
                  "dataclassification": "proprietary",
                  "owner": "platform-security",
                  "source": "ti-pipeline"
                },
                "lifecycle_rule": [
                  {
                    "action": [{ "storage_class": "", "type": "Delete" }],
                    "condition": [
                      {
                        "age": 5,
                        "created_before": "",
                        "custom_time_before": "",
                        "days_since_custom_time": 0,
                        "days_since_noncurrent_time": 0,
                        "matches_storage_class": [],
                        "noncurrent_time_before": "",
                        "num_newer_versions": 0,
                        "with_state": "ANY"
                      }
                    ]
                  },
                  {
                    "action": [
                      { "storage_class": "STANDARD", "type": "SetStorageClass" }
                    ],
                    "condition": [
                      {
                        "age": 10,
                        "created_before": "",
                        "custom_time_before": "",
                        "days_since_custom_time": 0,
                        "days_since_noncurrent_time": 0,
                        "matches_storage_class": [],
                        "noncurrent_time_before": "",
                        "num_newer_versions": 0,
                        "with_state": "ANY"
                      }
                    ]
                  }
                ],
                "location": "US-EAST4",
                "logging": [
                  {
                    "log_bucket": "bucket-test5",
                    "log_object_prefix": "storage-bucket-poc"
                  }
                ],
                "name": "storage-bucket-poc",
                "project": "digital-poc",
                "requester_pays": false,
                "retention_policy": [
                  { "is_locked": false, "retention_period": 3600 }
                ],
                "self_link": "https://www.googleapis.com/storage/v1/b/storage-bucket-poc",
                "storage_class": "STANDARD",
                "uniform_bucket_level_access": true,
                "url": "gs://storage-bucket-poc",
                "versioning": [{ "enabled": false }],
                "website": []
              },
              "sensitive_values": {
                "cors": [],
                "encryption": [{}],
                "labels": {},
                "lifecycle_rule": [
                  {
                    "action": [{}],
                    "condition": [{ "matches_storage_class": [] }]
                  },
                  {
                    "action": [{}],
                    "condition": [{ "matches_storage_class": [] }]
                  }
                ],
                "logging": [{}],
                "retention_policy": [{}],
                "versioning": [{}],
                "website": []
              }
            },
            {
              "address": "module.cloud_Storage.google_storage_bucket_iam_binding.admins[\"0\"]",
              "mode": "managed",
              "type": "google_storage_bucket_iam_binding",
              "name": "admins",
              "index": "0",
              "provider_name": "registry.terraform.io/hashicorp/google",
              "schema_version": 0,
              "values": {
                "bucket": "b/storage-bucket-poc",
                "condition": [],
                "etag": "CAY=",
                "id": "b/storage-bucket-poc/roles/storage.objectAdmin",
                "members": [
                  "serviceAccount:cloud-build-deploy-sa@digital-poc.iam.gserviceaccount.com",
                  "serviceAccount:poc-sa@ddev.iam.gserviceaccount.com"
                ],
                "role": "roles/storage.objectAdmin"
              },
              "sensitive_values": { "condition": [], "members": [false, false] }
            }
          ],
          "address": "module.cloud_Storage"
        }
      ]
    }
  },
  "resource_changes": [
    {
      "address": "module.cloud_Storage.google_storage_bucket.buckets",
      "module_address": "module.cloud_Storage",
      "mode": "managed",
      "type": "google_storage_bucket",
      "name": "buckets",
      "provider_name": "registry.terraform.io/hashicorp/google",
      "change": {
        "actions": ["no-op"],
        "before": {
          "bucket_policy_only": true,
          "cors": [],
          "default_event_based_hold": false,
          "encryption": [
            {
              "default_kms_key_name": "projects/cvs-key-vault-nonprod/locations/us-east4/pococ-us-east4"
            }
          ],
          "force_destroy": true,
          "id": "storage-bucket-poc",
          "labels": {
            "applicationid": "poc",
            "costcenter": "digital",
            "dataclassification": "proprietary",
            "owner": "platform-security",
            "source": "ti-pipeline"
          },
          "lifecycle_rule": [
            {
              "action": [{ "storage_class": "", "type": "Delete" }],
              "condition": [
                {
                  "age": 5,
                  "created_before": "",
                  "custom_time_before": "",
                  "days_since_custom_time": 0,
                  "days_since_noncurrent_time": 0,
                  "matches_storage_class": [],
                  "noncurrent_time_before": "",
                  "num_newer_versions": 0,
                  "with_state": "ANY"
                }
              ]
            },
            {
              "action": [
                { "storage_class": "STANDARD", "type": "SetStorageClass" }
              ],
              "condition": [
                {
                  "age": 10,
                  "created_before": "",
                  "custom_time_before": "",
                  "days_since_custom_time": 0,
                  "days_since_noncurrent_time": 0,
                  "matches_storage_class": [],
                  "noncurrent_time_before": "",
                  "num_newer_versions": 0,
                  "with_state": "ANY"
                }
              ]
            }
          ],
          "location": "US-EAST4",
          "logging": [
            {
              "log_bucket": "bucket-test5",
              "log_object_prefix": "storage-bucket-poc"
            }
          ],
          "name": "storage-bucket-poc",
          "project": "digital-poc",
          "requester_pays": false,
          "retention_policy": [
            { "is_locked": false, "retention_period": 3600 }
          ],
          "self_link": "https://www.googleapis.com/storage/v1/b/storage-bucket-poc",
          "storage_class": "STANDARD",
          "uniform_bucket_level_access": true,
          "url": "gs://storage-bucket-poc",
          "versioning": [{ "enabled": false }],
          "website": []
        },
        "after": {
          "bucket_policy_only": true,
          "cors": [],
          "default_event_based_hold": false,
          "encryption": [
            {
              "default_kms_key_name": "projects/cvs-key-vault-nonprod/locations/us-east4/pococ-us-east4"
            }
          ],
          "force_destroy": true,
          "id": "storage-bucket-poc",
          "labels": {
            "applicationid": "poc",
            "costcenter": "digital",
            "dataclassification": "proprietary",
            "owner": "platform-security",
            "source": "ti-pipeline"
          },
          "lifecycle_rule": [
            {
              "action": [{ "storage_class": "", "type": "Delete" }],
              "condition": [
                {
                  "age": 5,
                  "created_before": "",
                  "custom_time_before": "",
                  "days_since_custom_time": 0,
                  "days_since_noncurrent_time": 0,
                  "matches_storage_class": [],
                  "noncurrent_time_before": "",
                  "num_newer_versions": 0,
                  "with_state": "ANY"
                }
              ]
            },
            {
              "action": [
                { "storage_class": "STANDARD", "type": "SetStorageClass" }
              ],
              "condition": [
                {
                  "age": 10,
                  "created_before": "",
                  "custom_time_before": "",
                  "days_since_custom_time": 0,
                  "days_since_noncurrent_time": 0,
                  "matches_storage_class": [],
                  "noncurrent_time_before": "",
                  "num_newer_versions": 0,
                  "with_state": "ANY"
                }
              ]
            }
          ],
          "location": "US-EAST4",
          "logging": [
            {
              "log_bucket": "bucket-test5",
              "log_object_prefix": "storage-bucket-poc"
            }
          ],
          "name": "storage-bucket-poc",
          "project": "digital-poc",
          "requester_pays": false,
          "retention_policy": [
            { "is_locked": false, "retention_period": 3600 }
          ],
          "self_link": "https://www.googleapis.com/storage/v1/b/storage-bucket-poc",
          "storage_class": "STANDARD",
          "uniform_bucket_level_access": true,
          "url": "gs://storage-bucket-poc",
          "versioning": [{ "enabled": false }],
          "website": []
        },
        "after_unknown": {},
        "before_sensitive": {
          "cors": [],
          "encryption": [{}],
          "labels": {},
          "lifecycle_rule": [
            { "action": [{}], "condition": [{ "matches_storage_class": [] }] },
            { "action": [{}], "condition": [{ "matches_storage_class": [] }] }
          ],
          "logging": [{}],
          "retention_policy": [{}],
          "versioning": [{}],
          "website": []
        },
        "after_sensitive": {
          "cors": [],
          "encryption": [{}],
          "labels": {},
          "lifecycle_rule": [
            { "action": [{}], "condition": [{ "matches_storage_class": [] }] },
            { "action": [{}], "condition": [{ "matches_storage_class": [] }] }
          ],
          "logging": [{}],
          "retention_policy": [{}],
          "versioning": [{}],
          "website": []
        }
      }
    },
    {
      "address": "module.cloud_Storage.google_storage_bucket_iam_binding.admins[\"0\"]",
      "module_address": "module.cloud_Storage",
      "mode": "managed",
      "type": "google_storage_bucket_iam_binding",
      "name": "admins",
      "index": "0",
      "provider_name": "registry.terraform.io/hashicorp/google",
      "change": {
        "actions": ["no-op"],
        "before": {
          "bucket": "b/storage-bucket-poc",
          "condition": [],
          "etag": "CAY=",
          "id": "b/storage-bucket-poc/roles/storage.objectAdmin",
          "members": [
            "serviceAccount:cloud-build-deploy-sa@digital-poc.iam.gserviceaccount.com",
            "serviceAccount:poc-sa@ddev.iam.gserviceaccount.com"
          ],
          "role": "roles/storage.objectAdmin"
        },
        "after": {
          "bucket": "b/storage-bucket-poc",
          "condition": [],
          "etag": "CAY=",
          "id": "b/storage-bucket-poc/roles/storage.objectAdmin",
          "members": [
            "serviceAccount:cloud-build-deploy-sa@digital-poc.iam.gserviceaccount.com",
            "serviceAccount:poc-sa@ddev.iam.gserviceaccount.com"
          ],
          "role": "roles/storage.objectAdmin"
        },
        "after_unknown": {},
        "before_sensitive": { "condition": [], "members": [false, false] },
        "after_sensitive": { "condition": [], "members": [false, false] }
      }
    }
  ],
  "prior_state": {
    "format_version": "1.0",
    "terraform_version": "1.6.2",
    "values": {
      "root_module": {
        "child_modules": [
          {
            "resources": [
              {
                "address": "module.cloud_Storage.google_storage_bucket.buckets",
                "mode": "managed",
                "type": "google_storage_bucket",
                "name": "buckets",
                "provider_name": "registry.terraform.io/hashicorp/google",
                "schema_version": 0,
                "values": {
                  "bucket_policy_only": true,
                  "cors": [],
                  "default_event_based_hold": false,
                  "encryption": [
                    {
                      "default_kms_key_name": "projects/cvs-key-vault-nonprod/locations/us-east4/pococ-us-east4"
                    }
                  ],
                  "force_destroy": true,
                  "id": "storage-bucket-poc",
                  "labels": {
                    "applicationid": "poc",
                    "costcenter": "digital",
                    "dataclassification": "proprietary",
                    "owner": "platform-security",
                    "source": "ti-pipeline"
                  },
                  "lifecycle_rule": [
                    {
                      "action": [{ "storage_class": "", "type": "Delete" }],
                      "condition": [
                        {
                          "age": 5,
                          "created_before": "",
                          "custom_time_before": "",
                          "days_since_custom_time": 0,
                          "days_since_noncurrent_time": 0,
                          "matches_storage_class": [],
                          "noncurrent_time_before": "",
                          "num_newer_versions": 0,
                          "with_state": "ANY"
                        }
                      ]
                    },
                    {
                      "action": [
                        {
                          "storage_class": "STANDARD",
                          "type": "SetStorageClass"
                        }
                      ],
                      "condition": [
                        {
                          "age": 10,
                          "created_before": "",
                          "custom_time_before": "",
                          "days_since_custom_time": 0,
                          "days_since_noncurrent_time": 0,
                          "matches_storage_class": [],
                          "noncurrent_time_before": "",
                          "num_newer_versions": 0,
                          "with_state": "ANY"
                        }
                      ]
                    }
                  ],
                  "location": "US-EAST4",
                  "logging": [
                    {
                      "log_bucket": "bucket-test5",
                      "log_object_prefix": "storage-bucket-poc"
                    }
                  ],
                  "name": "storage-bucket-poc",
                  "project": "digital-poc",
                  "requester_pays": false,
                  "retention_policy": [
                    { "is_locked": false, "retention_period": 3600 }
                  ],
                  "self_link": "https://www.googleapis.com/storage/v1/b/storage-bucket-poc",
                  "storage_class": "STANDARD",
                  "uniform_bucket_level_access": true,
                  "url": "gs://storage-bucket-poc",
                  "versioning": [{ "enabled": false }],
                  "website": []
                },
                "sensitive_values": {
                  "cors": [],
                  "encryption": [{}],
                  "labels": {},
                  "lifecycle_rule": [
                    {
                      "action": [{}],
                      "condition": [{ "matches_storage_class": [] }]
                    },
                    {
                      "action": [{}],
                      "condition": [{ "matches_storage_class": [] }]
                    }
                  ],
                  "logging": [{}],
                  "retention_policy": [{}],
                  "versioning": [{}],
                  "website": []
                }
              },
              {
                "address": "module.cloud_Storage.google_storage_bucket_iam_binding.admins[\"0\"]",
                "mode": "managed",
                "type": "google_storage_bucket_iam_binding",
                "name": "admins",
                "index": "0",
                "provider_name": "registry.terraform.io/hashicorp/google",
                "schema_version": 0,
                "values": {
                  "bucket": "b/storage-bucket-poc",
                  "condition": [],
                  "etag": "CAY=",
                  "id": "b/storage-bucket-poc/roles/storage.objectAdmin",
                  "members": [
                    "serviceAccount:cloud-build-deploy-sa@digital-poc.iam.gserviceaccount.com",
                    "serviceAccount:poc-sa@ddev.iam.gserviceaccount.com"
                  ],
                  "role": "roles/storage.objectAdmin"
                },
                "sensitive_values": {
                  "condition": [],
                  "members": [false, false]
                },
                "depends_on": [
                  "module.cloud_Storage.google_storage_bucket.buckets"
                ]
              }
            ],
            "address": "module.cloud_Storage"
          }
        ]
      }
    }
  },
  "configuration": {
    "provider_config": {
      "google": {
        "name": "google",
        "full_name": "registry.terraform.io/hashicorp/google",
        "version_constraint": "~\u003e 3.86.0",
        "expressions": {
          "project": { "references": ["var.project_id"] },
          "region": { "references": ["var.region"] },
          "zone": { "references": ["var.zone"] }
        }
      },
      "module.cloud_Storage:google": {
        "name": "google",
        "full_name": "registry.terraform.io/hashicorp/google",
        "module_address": "module.cloud_Storage",
        "expressions": {
          "project": { "references": ["var.project_id"] },
          "region": { "references": ["var.region"] },
          "zone": { "references": ["var.zone"] }
        }
      }
    },
    "root_module": {
      "module_calls": {
        "cloud_Storage": {
          "source": "git::https://github.com/cvs-health-source-code/terraform-google-cloudstorage.git",
          "expressions": {
            "access": { "references": ["var.access"] },
            "bucket_encryption_key": {
              "references": ["var.bucket_encryption_key"]
            },
            "bucket_labels": { "references": ["var.bucket_labels"] },
            "bucket_location": { "references": ["var.bucket_location"] },
            "bucket_name": { "references": ["var.bucket_name"] },
            "enable_versioning": { "references": ["var.enable_versioning"] },
            "lifecycle_delete_age_rules": {
              "references": ["var.lifecycle_delete_age_rules"]
            },
            "lifecycle_storageclass_age_rules": {
              "references": ["var.lifecycle_storageclass_age_rules"]
            },
            "log_bucket_name": { "references": ["var.log_bucket_name"] },
            "project_id": { "references": ["var.project_id"] },
            "region": { "references": ["var.region"] },
            "retention_policy_values": {
              "references": ["var.retention_policy_values"]
            },
            "zone": { "references": ["var.zone"] }
          },
          "module": {
            "outputs": {
              "cloud_storage_bucket_name": {
                "expression": {
                  "references": [
                    "google_storage_bucket.buckets.name",
                    "google_storage_bucket.buckets"
                  ]
                },
                "description": "Bucket name. Should confirm to the naming standards defined here: TBD"
              },
              "cloud_storage_bucket_urls": {
                "expression": {
                  "references": [
                    "google_storage_bucket.buckets.url",
                    "google_storage_bucket.buckets"
                  ]
                },
                "description": "URL of bucket in the form gs://{cloud_storage_bucket_name}"
              }
            },
            "resources": [
              {
                "address": "google_storage_bucket.buckets",
                "mode": "managed",
                "type": "google_storage_bucket",
                "name": "buckets",
                "provider_config_key": "module.cloud_Storage:google",
                "expressions": {
                  "force_destroy": { "constant_value": true },
                  "labels": {
                    "references": ["var.bucket_labels", "var.default_labels"]
                  },
                  "location": { "references": ["var.bucket_location"] },
                  "logging": [
                    { "log_bucket": { "references": ["var.log_bucket_name"] } }
                  ],
                  "name": { "references": ["var.bucket_name"] },
                  "requester_pays": { "constant_value": false },
                  "storage_class": {
                    "references": ["var.bucket_storage_class"]
                  },
                  "uniform_bucket_level_access": { "constant_value": true },
                  "versioning": [
                    { "enabled": { "references": ["var.enable_versioning"] } }
                  ]
                },
                "schema_version": 0
              },
              {
                "address": "google_storage_bucket_iam_binding.admins",
                "mode": "managed",
                "type": "google_storage_bucket_iam_binding",
                "name": "admins",
                "provider_config_key": "module.cloud_Storage:google",
                "expressions": {
                  "bucket": {
                    "references": ["each.value.bucket_name", "each.value"]
                  },
                  "members": {
                    "references": ["each.value.members", "each.value"]
                  },
                  "role": { "references": ["each.value.role", "each.value"] }
                },
                "schema_version": 0,
                "for_each_expression": { "references": ["local.access_list"] }
              }
            ],
            "variables": {
              "access": { "description": "Bucket access based on role." },
              "bucket_encryption_key": {
                "description": "Key to encrypt contents of the bucket."
              },
              "bucket_labels": {
                "description": "requester_pays_enabled set to false"
              },
              "bucket_location": {
                "description": "Region of the cloudstorage bucket"
              },
              "bucket_name": {
                "description": "Name of the cloudstorage bucket"
              },
              "bucket_storage_class": {
                "default": "STANDARD",
                "description": "Storage_class of the cloudstorage bucket"
              },
              "default_labels": {
                "default": { "source": "ti-pipeline" },
                "description": "source label to identify that resource is being created using the ti pipeline."
              },
              "enable_versioning": {
                "default": false,
                "description": "Enable GCS Bucket versioning."
              },
              "lifecycle_delete_age_rules": {
                "default": null,
                "description": "Lifecycle age to delete the bucket."
              },
              "lifecycle_storageclass_age_rules": {
                "default": null,
                "description": "Lifecycle Bucket storage."
              },
              "log_bucket_name": {
                "description": "Name of the Bucket used to store access logs"
              },
              "project_id": {
                "description": "The project ID to manage the Cloud storage resources"
              },
              "region": {
                "description": "The name of the Cloud storage resources"
              },
              "retention_policy_values": {
                "default": null,
                "description": "Configuration of the bucket's data retention policy for how long objects in the bucket should be retained."
              },
              "zone": {
                "description": "The zone for the master instance, it should be something like: `us-central1-a`, `us-east1-c`."
              }
            }
          }
        }
      },
      "variables": {
        "access": { "description": "Bucket access based on role." },
        "bucket_encryption_key": {
          "default": [null],
          "description": "Key to encrypt contents of the bucket."
        },
        "bucket_labels": {
          "description": "requester_pays_enabled set to false"
        },
        "bucket_location": {
          "description": "Region of the cloudstorage bucket"
        },
        "bucket_name": { "description": "Name of the cloudstorage bucket" },
        "enable_versioning": { "description": "Enable GCS Bucket versioning." },
        "github_organization": {},
        "lifecycle_delete_age_rules": {
          "description": "Lifecycle age to delete the bucket."
        },
        "lifecycle_storageclass_age_rules": {
          "description": "Lifecycle Bucket storage."
        },
        "log_bucket_name": {
          "description": "Name of the Bucket used to store access logs"
        },
        "project_id": {
          "description": "The project ID to manage the Cloud SQL resources"
        },
        "region": { "description": "The name of the Cloud SQL resources" },
        "retention_policy_values": {
          "default": { "is_locked": false, "retention_period": 5 },
          "description": "Configuration of the bucket's data retention policy for how long objects in the bucket should be retained."
        },
        "zone": {
          "description": "The zone for the master instance, it should be something like: `us-central1-a`, `us-east1-c`."
        }
      }
    }
  },
  "relevant_attributes": [
    {
      "resource": "module.cloud_Storage.google_storage_bucket.buckets",
      "attribute": ["url"]
    },
    {
      "resource": "module.cloud_Storage.google_storage_bucket.buckets",
      "attribute": ["name"]
    }
  ],
  "timestamp": "2023-10-20T14:32:50Z",
  "errored": false
}
